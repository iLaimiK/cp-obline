import{q as e,b as a,o as l,a as s,w as o,d as t,e as r,t as u,i as n,h as i,D as d,l as c,j as p,c as m,f,F as _,z as v}from"./index-SNMhby7L.js";import{_ as b}from"./uni-icons.GkTfaCN8.js";import{r as h}from"./uni-app.es.CqodLWiA.js";import{_ as y}from"./uni-easyinput.Sk3ZZ7wt.js";import{_ as g,a as k}from"./uni-forms.DO5j5MHi.js";import{_ as w}from"./uni-countdown.OwkuUEEk.js";import{v as C,l as j,a as x,b as V}from"./user.CMNANS_S.js";import{u as q}from"./http.CqkQg3YM.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";const M={options:{styleIsolation:"shared"}},z=T(Object.assign(M,{__name:"mobile",setup(p){const m=q(),f=e(!1),_=e(!1),v=e("获取验证码"),b=e(),x=e({mobile:"",code:""}),V=e({mobile:{rules:[{required:!0,errorMessage:"请输入手机号"},{pattern:"^(?:(?:\\+|00)86)?1(?:(?:3[\\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\\d])|(?:9[1589]))\\d{8}$",errorMessage:"手机号格式不正确"}]},code:{rules:[{required:!0,errorMessage:"请输入验证码"},{pattern:"^\\d{6}$",errorMessage:"验证码格式不正确"}]}}),T=e=>{f.value=!f.value},M=async()=>{await b.value.validateField(["mobile"]);const e=await C({mobile:x.value.mobile,type:"login"});if(1e4!==e.code)return uni.utils.toast(e.message);uni.utils.toast("验证码已发送"),_.value=!0,console.log(e)},z=()=>{_.value=!1,v.value="重新获取"};return(e,p)=>{const C=h(a("uni-easyinput"),y),q=h(a("uni-forms-item"),g),I=h(a("uni-countdown"),w),U=n,A=i,$=d,F=c,L=h(a("uni-forms"),k);return l(),s(L,{class:"login-form",ref_key:"form",ref:b,model:x.value,rules:V.value},{default:o((()=>[t(q,{name:"mobile"},{default:o((()=>[t(C,{"input-border":!1,clearable:!1,modelValue:x.value.mobile,"onUpdate:modelValue":p[0]||(p[0]=e=>x.value.mobile=e),placeholder:"请输入手机号","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),t(q,{name:"code"},{default:o((()=>[t(C,{"input-border":!1,clearable:!1,modelValue:x.value.code,"onUpdate:modelValue":p[1]||(p[1]=e=>x.value.code=e),placeholder:"请输入验证码","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"]),_.value?(l(),s(U,{key:0,class:"text-button"},{default:o((()=>[t(I,{"show-day":!1,"show-hour":!1,"show-minute":!1,second:10,onTimeup:z,color:"#16C2A3"}),r("秒后重试 ")])),_:1})):(l(),s(A,{key:1,onClick:M,class:"text-button"},{default:o((()=>[r(u(v.value),1)])),_:1}))])),_:1}),t(U,{class:"agreement"},{default:o((()=>[t($,{onClick:T,checked:f.value,color:"#16C2A3"},null,8,["checked"]),r(" 我已同意 "),t(A,{class:"link"},{default:o((()=>[r("用户协议")])),_:1}),r(" 及 "),t(A,{class:"link"},{default:o((()=>[r("隐私协议")])),_:1})])),_:1}),t(F,{onClick:p[2]||(p[2]=e=>(async()=>{if(!f.value)return uni.utils.toast("请同意协议！");try{const e=await b.value.validate(),a=await j(e);if(1e4!==a.code)return uni.utils.toast(a.message);m.token=a.data.token,m.refreshToken=a.data.refreshToken,m.userId=a.data.id,uni[m.openType]({url:m.redirectURL})}catch(e){console.log(e)}})()),class:"uni-button"},{default:o((()=>[r("登 录")])),_:1})])),_:1},8,["model","rules"])}}}),[["__scopeId","data-v-116d3836"]]),I={options:{styleIsolation:"shared"}},U=T(Object.assign(I,{__name:"password",setup(u){const m=q(),f=e(!1),_=e({mobile:"13212345678",password:"abc12345"}),v=e({mobile:{rules:[{required:!0,errorMessage:"请输入手机号"},{pattern:"^1[3-9]\\d{9}$",errorMessage:"手机号格式不正确"}]},password:{rules:[{required:!0,errorMessage:"请输入密码"},{pattern:"^[0-9A-Za-z]{6,12}$",errorMessage:"密码必须是由字母和数字组成的6到12位字符"}]}}),b=e();return(e,u)=>{const w=h(a("uni-easyinput"),y),C=h(a("uni-forms-item"),g),j=d,V=i,q=n,T=c,M=p,z=h(a("uni-forms"),k);return l(),s(z,{class:"login-form",ref_key:"form",ref:b,model:_.value,rules:v.value},{default:o((()=>[t(C,{name:"mobile"},{default:o((()=>[t(w,{"input-border":!1,clearable:!1,modelValue:_.value.mobile,"onUpdate:modelValue":u[0]||(u[0]=e=>_.value.mobile=e),placeholder:"请输入手机号","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),t(C,{name:"password"},{default:o((()=>[t(w,{type:"password",modelValue:_.value.password,"onUpdate:modelValue":u[1]||(u[1]=e=>_.value.password=e),placeholder:"请输入密码","input-border":!1,"placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),t(q,{class:"agreement"},{default:o((()=>[t(j,{onClick:u[2]||(u[2]=e=>{f.value=!f.value}),checked:f.value,color:"#16C2A3"},null,8,["checked"]),r(" 我已同意 "),t(V,{class:"link"},{default:o((()=>[r("用户协议")])),_:1}),r(" 及 "),t(V,{class:"link"},{default:o((()=>[r("隐私协议")])),_:1})])),_:1}),t(T,{class:"uni-button",onClick:u[3]||(u[3]=e=>(async()=>{if(!f.value)return uni.utils.toast("请同意协议！");const e=await b.value.validate(),a=await x(e);if(1e4!==a.code)return uni.utils.toast(a.message);m.token=a.data.token,m.refreshToken=a.data.refreshToken,m.userId=a.data.id,uni[m.openType]({url:m.redirectURL})})())},{default:o((()=>[r("登 录")])),_:1}),t(M,{"hover-class":"none",class:"uni-navigator",url:" "},{default:o((()=>[r(" 忘记密码？ ")])),_:1})])),_:1},8,["model","rules"])}}}),[["__scopeId","data-v-11c60be0"]]),A=T({__name:"index",setup(d){V(13212345678);const c=[{title:"密码登录",subTitle:"验证码登录"},{title:"验证码登录",subTitle:"密码登录"}],p=e(0),y=m((()=>c[p.value]));const g=()=>{window.location.href="https://graph.qq.com/oauth2.0/authorize?response_type=token&client_id=102015968&redirect_uri=http://consult-patients.itheima.net/pages/login/qq"};return(e,d)=>{const c=n,m=i,k=h(a("uni-icons"),b);return l(),f(_,null,[t(c,{class:"user-login"},{default:o((()=>[t(c,{class:"login-type"},{default:o((()=>[t(c,{class:"title"},{default:o((()=>[r(u(y.value.title),1)])),_:1}),t(c,{onClick:d[0]||(d[0]=e=>{p.value=Math.abs(p.value-1)}),class:"type"},{default:o((()=>[t(m,null,{default:o((()=>[r(u(y.value.subTitle),1)])),_:1}),t(k,{size:"32rpx",color:"#3c3e42",type:"forward"})])),_:1})])),_:1})])),_:1}),t(c,{class:"login-form-wrap"},{default:o((()=>[0===p.value?(l(),s(U,{key:0})):v("",!0),1===p.value?(l(),s(z,{key:1})):v("",!0)])),_:1}),t(c,{class:"social-login"},{default:o((()=>[t(c,{class:"legend"},{default:o((()=>[t(m,{class:"text"},{default:o((()=>[r("其它方式登录")])),_:1})])),_:1}),t(c,{class:"social-account"},{default:o((()=>[t(c,{onClick:g,class:"icon"},{default:o((()=>[t(k,{color:"#00b0fb",size:"50rpx",type:"qq"})])),_:1}),t(c,{class:"icon"},{default:o((()=>[t(k,{color:"#fb6622",size:"50rpx",type:"weibo"})])),_:1}),t(c,{class:"icon"},{default:o((()=>[t(k,{color:"#07C160",size:"50rpx",type:"weixin"})])),_:1})])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-e71eb39c"]]);export{A as default};

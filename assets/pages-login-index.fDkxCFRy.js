import{q as e,b as a,o as l,a as s,w as o,d as t,e as r,t as u,D as n,E as i,i as d,h as c,G as p,l as m,j as f,c as _,f as v,F as b,z as h}from"./index-BC-67zmo.js";import{_ as y}from"./uni-icons.BOY_Jubr.js";import{r as g}from"./uni-app.es.9K6jfBy6.js";import{_ as k}from"./uni-easyinput.BDvhMVCq.js";import{_ as w,a as C}from"./uni-forms.Co7B8_qp.js";import{_ as x}from"./uni-countdown.DS_5itOV.js";import{v as j,l as T,a as V,b as q}from"./user.DfNG0o2c.js";import{u as z}from"./http.Cf7yvREa.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";const U={options:{styleIsolation:"shared"}},I=M(Object.assign(U,{__name:"mobile",setup(f){const _=z(),v=e(!1),b=e(!1),h=e("获取验证码"),y=e(),V=e({mobile:"",code:""}),q=e({mobile:{rules:[{required:!0,errorMessage:"请输入手机号"},{pattern:"^(?:(?:\\+|00)86)?1(?:(?:3[\\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\\d])|(?:9[1589]))\\d{8}$",errorMessage:"手机号格式不正确"}]},code:{rules:[{required:!0,errorMessage:"请输入验证码"},{pattern:"^\\d{6}$",errorMessage:"验证码格式不正确"}]}}),M=e=>{v.value=!v.value},U=async()=>{await y.value.validateField(["mobile"]);const e=await j({mobile:V.value.mobile,type:"login"});if(1e4!==e.code)return uni.utils.toast(e.message);uni.utils.toast("验证码已发送"),b.value=!0,console.log(e)},I=()=>{b.value=!1,h.value="重新获取"};return(e,f)=>{const j=g(a("uni-easyinput"),k),z=g(a("uni-forms-item"),w),A=g(a("uni-countdown"),x),L=d,R=c,$=p,F=m,O=g(a("uni-forms"),C);return l(),s(O,{class:"login-form",ref_key:"form",ref:y,model:V.value,rules:q.value},{default:o((()=>[t(z,{name:"mobile"},{default:o((()=>[t(j,{"input-border":!1,clearable:!1,modelValue:V.value.mobile,"onUpdate:modelValue":f[0]||(f[0]=e=>V.value.mobile=e),placeholder:"请输入手机号","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),t(z,{name:"code"},{default:o((()=>[t(j,{"input-border":!1,clearable:!1,modelValue:V.value.code,"onUpdate:modelValue":f[1]||(f[1]=e=>V.value.code=e),placeholder:"请输入验证码","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"]),b.value?(l(),s(L,{key:0,class:"text-button"},{default:o((()=>[t(A,{"show-day":!1,"show-hour":!1,"show-minute":!1,second:10,onTimeup:I,color:"#16C2A3"}),r("秒后重试 ")])),_:1})):(l(),s(R,{key:1,onClick:U,class:"text-button"},{default:o((()=>[r(u(h.value),1)])),_:1}))])),_:1}),t(L,{class:"agreement"},{default:o((()=>[t($,{onClick:M,checked:v.value,color:"#16C2A3"},null,8,["checked"]),r(" 我已同意 "),t(R,{class:"link"},{default:o((()=>[r("用户协议")])),_:1}),r(" 及 "),t(R,{class:"link"},{default:o((()=>[r("隐私协议")])),_:1})])),_:1}),t(F,{onClick:f[2]||(f[2]=e=>(async()=>{if(!v.value)return uni.utils.toast("请同意协议！");try{const e=await y.value.validate(),a=await T(e);if(1e4!==a.code)return uni.utils.toast(a.message);_.token=a.data.token,_.refreshToken=a.data.refreshToken,_.userId=a.data.id,"switchTab"===_.openType?n({url:_.redirectURL}):i({url:_.redirectURL})}catch(e){console.log(e)}})()),class:"uni-button"},{default:o((()=>[r("登 录")])),_:1})])),_:1},8,["model","rules"])}}}),[["__scopeId","data-v-58dc16f3"]]),A={options:{styleIsolation:"shared"}},L=M(Object.assign(A,{__name:"password",setup(u){const _=z(),v=e(!1),b=e({mobile:"13212345678",password:"abc12345"}),h=e({mobile:{rules:[{required:!0,errorMessage:"请输入手机号"},{pattern:"^1[3-9]\\d{9}$",errorMessage:"手机号格式不正确"}]},password:{rules:[{required:!0,errorMessage:"请输入密码"},{pattern:"^[0-9A-Za-z]{6,12}$",errorMessage:"密码必须是由字母和数字组成的6到12位字符"}]}}),y=e();return(e,u)=>{const x=g(a("uni-easyinput"),k),j=g(a("uni-forms-item"),w),T=p,q=c,z=d,M=m,U=f,I=g(a("uni-forms"),C);return l(),s(I,{class:"login-form",ref_key:"form",ref:y,model:b.value,rules:h.value},{default:o((()=>[t(j,{name:"mobile"},{default:o((()=>[t(x,{"input-border":!1,clearable:!1,modelValue:b.value.mobile,"onUpdate:modelValue":u[0]||(u[0]=e=>b.value.mobile=e),placeholder:"请输入手机号","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),t(j,{name:"password"},{default:o((()=>[t(x,{type:"password",modelValue:b.value.password,"onUpdate:modelValue":u[1]||(u[1]=e=>b.value.password=e),placeholder:"请输入密码","input-border":!1,"placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),t(z,{class:"agreement"},{default:o((()=>[t(T,{onClick:u[2]||(u[2]=e=>{v.value=!v.value}),checked:v.value,color:"#16C2A3"},null,8,["checked"]),r(" 我已同意 "),t(q,{class:"link"},{default:o((()=>[r("用户协议")])),_:1}),r(" 及 "),t(q,{class:"link"},{default:o((()=>[r("隐私协议")])),_:1})])),_:1}),t(M,{class:"uni-button",onClick:u[3]||(u[3]=e=>(async()=>{if(!v.value)return uni.utils.toast("请同意协议！");const e=await y.value.validate(),a=await V(e);if(1e4!==a.code)return uni.utils.toast(a.message);_.token=a.data.token,_.refreshToken=a.data.refreshToken,_.userId=a.data.id,"switchTab"===_.openType?n({url:_.redirectURL}):i({url:_.redirectURL})})())},{default:o((()=>[r("登 录")])),_:1}),t(U,{"hover-class":"none",class:"uni-navigator",url:" "},{default:o((()=>[r(" 忘记密码？ ")])),_:1})])),_:1},8,["model","rules"])}}}),[["__scopeId","data-v-c8a46a32"]]),R=M({__name:"index",setup(n){q(13212345678);const i=[{title:"密码登录",subTitle:"验证码登录"},{title:"验证码登录",subTitle:"密码登录"}],p=e(0),m=_((()=>i[p.value]));const f=()=>{window.location.href="https://graph.qq.com/oauth2.0/authorize?response_type=token&client_id=102015968&redirect_uri=https://cp-online.anvelpro.xyz/pages/login/qq"};return(e,n)=>{const i=d,_=c,k=g(a("uni-icons"),y);return l(),v(b,null,[t(i,{class:"user-login"},{default:o((()=>[t(i,{class:"login-type"},{default:o((()=>[t(i,{class:"title"},{default:o((()=>[r(u(m.value.title),1)])),_:1}),t(i,{onClick:n[0]||(n[0]=e=>{p.value=Math.abs(p.value-1)}),class:"type"},{default:o((()=>[t(_,null,{default:o((()=>[r(u(m.value.subTitle),1)])),_:1}),t(k,{size:"32rpx",color:"#3c3e42",type:"forward"})])),_:1})])),_:1})])),_:1}),t(i,{class:"login-form-wrap"},{default:o((()=>[0===p.value?(l(),s(L,{key:0})):h("",!0),1===p.value?(l(),s(I,{key:1})):h("",!0)])),_:1}),t(i,{class:"social-login"},{default:o((()=>[t(i,{class:"legend"},{default:o((()=>[t(_,{class:"text"},{default:o((()=>[r("其它方式登录")])),_:1})])),_:1}),t(i,{class:"social-account"},{default:o((()=>[t(i,{onClick:f,class:"icon"},{default:o((()=>[t(k,{color:"#00b0fb",size:"50rpx",type:"qq"})])),_:1}),t(i,{class:"icon"},{default:o((()=>[t(k,{color:"#fb6622",size:"50rpx",type:"weibo"})])),_:1}),t(i,{class:"icon"},{default:o((()=>[t(k,{color:"#07C160",size:"50rpx",type:"weixin"})])),_:1})])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-bcfe467d"]]);export{R as default};

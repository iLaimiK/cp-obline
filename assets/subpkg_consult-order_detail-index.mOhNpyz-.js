import{q as t,m as a,b as e,o as l,a as s,w as u,d as o,e as n,t as i,z as r,f as c,F as d,h as f,i as _,k as v,l as p}from"./index-SNMhby7L.js";import{_ as m}from"./uni-icons.GkTfaCN8.js";import{r as g}from"./uni-app.es.CqodLWiA.js";import{a as b,b as h}from"./uni-list.0gdjOmcT.js";import{_ as x}from"./uni-notice-bar.CnYQGK5V.js";import{_ as y}from"./scroll-page.D5HVTT5K.js";import{g as w}from"./consult.CHO2TwaP.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./http.CqkQg3YM.js";const j=I({__name:"index",props:{id:String},setup(I){const j=I,k=t({1:"问医生",2:"极速问诊",3:"开药问诊"});function $(t){const a=Math.floor(t/3600),e=Math.floor(t%3600/60),l=Math.floor(t%60);return`${a.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`}t({1:"待支付",2:"待接诊",3:"咨询中",4:"已完成",5:"已取消"});const S=t({}),N=async()=>{const t=await w(j.id);if(1e4!==t.code)return uni.utils.toast(t.message);S.value=t.data,S.value.countdown&&S.value.countdown>0&&setInterval((()=>{S.value.countdown>0?S.value.countdown--:0===S.value.countdown&&z()}),1e3)},z=async()=>{await N()};return a((async()=>{await N()})),(t,a)=>{const w=f,I=_,j=v,N=g(e("uni-icons"),m),z=g(e("uni-list-item"),b),C=g(e("uni-list"),h),D=g(e("uni-notice-bar"),x),F=p,M=g(e("scroll-page"),y);return l(),s(M,{"background-color":"#f6f6f6"},{default:u((()=>[S.value.id?(l(),s(I,{key:0,class:"consult-page"},{default:u((()=>[o(I,{class:"page-header"},{default:u((()=>[o(I,{class:"order-status"},{default:u((()=>[o(I,{class:"label"},{default:u((()=>[o(w,{class:"title"},{default:u((()=>[n(i(k.value[S.value.type])+" "+i(S.value.actualPayment)+"元",1)])),_:1}),5===S.value.status?(l(),s(w,{key:0,class:"tips"},{default:u((()=>[n(" 取消/退款进度：您的订单已取消，诊金将在1-7个工作日内退回原支付账户。 ")])),_:1})):r("",!0)])),_:1}),o(w,{class:"status"},{default:u((()=>[n(i(S.value.statusValue),1)])),_:1})])),_:1}),3===S.value.status||4===S.value.status?(l(),s(I,{key:0,class:"consult-doctor"},{default:u((()=>[o(w,{class:"lable"},{default:u((()=>[n("服务医生信息")])),_:1}),o(I,{class:"doctor"},{default:u((()=>[o(j,{class:"doctor-avatar",src:S.value.docInfo.avatar},null,8,["src"]),o(I,{class:"doctor-info"},{default:u((()=>[o(I,{class:"meta"},{default:u((()=>[o(w,{class:"name"},{default:u((()=>[n(i(S.value.docInfo.name),1)])),_:1}),o(w,{class:"title"},{default:u((()=>[n(i(S.value.docInfo.depName)+" | "+i(S.value.docInfo.positionalTitles),1)])),_:1})])),_:1}),o(I,{class:"meta"},{default:u((()=>[o(w,{class:"tag"},{default:u((()=>[n(i(S.value.docInfo.gradeName),1)])),_:1}),o(w,{class:"hospital"},{default:u((()=>[n(i(S.value.docInfo.hospitalName),1)])),_:1})])),_:1})])),_:1}),o(I,{class:"arrow"},{default:u((()=>[o(N,{size:"18",color:"#C3C3C5",type:"forward"})])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1}),o(I,{class:"consult-patient"},{default:u((()=>[o(I,{class:"list-title"},{default:u((()=>[n("患者资料")])),_:1}),o(C,{border:!1},{default:u((()=>{var t,a,e;return[o(z,{title:"患者信息","right-text":`${null==(t=S.value.patientInfo)?void 0:t.name} | ${null==(a=S.value.patientInfo)?void 0:a.genderValue} | ${null==(e=S.value.patientInfo)?void 0:e.age}岁`},null,8,["right-text"]),o(z,{title:"病情描述",note:S.value.illnessDesc},null,8,["note"])]})),_:1})])),_:1}),o(I,{class:"order-info"},{default:u((()=>[o(I,{class:"list-title"},{default:u((()=>[n("订单信息")])),_:1}),o(C,{border:!1},{default:u((()=>[o(z,{title:"订单编号","right-text":S.value.orderNo},null,8,["right-text"]),o(z,{title:"创建时间","right-text":S.value.createTime},null,8,["right-text"]),o(z,{title:"应付款","right-text":`¥${S.value.payment}`},null,8,["right-text"]),o(z,{title:"优惠券"},{footer:u((()=>[o(I,{class:"uni-list-text-red"},{default:u((()=>[n("-¥"+i(S.value.couponDeduction),1)])),_:1})])),_:1}),o(z,{title:"积分抵扣"},{footer:u((()=>[o(I,{class:"uni-list-text-red"},{default:u((()=>[n("-¥"+i(S.value.pointDeduction),1)])),_:1})])),_:1}),o(z,{title:"实付款"},{footer:u((()=>[o(I,{class:"uni-list-text-red"},{default:u((()=>[n("¥"+i(S.value.actualPayment),1)])),_:1})])),_:1})])),_:1})])),_:1}),o(I,{class:"notice-bar"},{default:u((()=>[1===S.value.status||S.value.countdown>0?(l(),s(D,{key:0,text:`请在 ${$(S.value.countdown)} 内完成支付，超时订单将取消`},null,8,["text"])):r("",!0)])),_:1}),o(I,{class:"toolbar"},{default:u((()=>[1===S.value.status?(l(),c(d,{key:0},[o(I,{class:"total-amount"},{default:u((()=>[n(" 需付款: "),o(w,{class:"number"},{default:u((()=>[n("¥"+i(S.value.actualPayment.toFixed(2)),1)])),_:1})])),_:1}),o(I,{class:"buttons"},{default:u((()=>[o(F,{class:"uni-button minor"},{default:u((()=>[n("取消问诊")])),_:1}),o(F,{class:"uni-button"},{default:u((()=>[n("立即支付")])),_:1})])),_:1})],64)):(l(),s(I,{key:1,class:"buttons"},{default:u((()=>[o(I,{class:"delete-botton"},{default:u((()=>[o(N,{size:"24",color:"#848484",type:"trash"}),o(w,null,{default:u((()=>[n("删除订单")])),_:1})])),_:1}),o(F,{class:"uni-button"},{default:u((()=>[n("再次购买")])),_:1})])),_:1}))])),_:1})])),_:1})):r("",!0)])),_:1})}}},[["__scopeId","data-v-5285158c"]]);export{j as default};
